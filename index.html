<!DOCTYPE html>
<head>
    <title>KOJS Calendar Component</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.3.0/knockout-min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.2.2/milligram.min.css">
</head>
<body>
    <div id="wrapper">
        <div>
            <h1 data-bind="text: date"></h1>
            <h1 data-bind="text: daysOfMonth"></h1>
        </div>
        <div style="display: block;">
            <button data-bind="click : minusMonth" class="button-clear" id="l-arrow">-</button>
            <button data-bind="click : plusMonth" class="button-clear" id="r-arrow">+</button>
        </div>
        <div id="cal-wrapper">
            <div>Su</div>
            <div>M</div>
            <div>T</div>
            <div>W</div>
            <div>Th</div>
            <div>F</div>
            <div>Sa</div>
            <div id="daydiv" data-bind="foreach: days">
                <div data-bind="text: $data"></div>
            </div>
        </div>
    </div>
</body>
<style>
    #wrapper {
        padding: 12%;
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: center;
        width: 100%;
    }

    #cal-wrapper {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
        align-items: center;
        align-content: stretch;
        width: 100%;
        height: 100px;
        text-align: center;
    }

    #cal-header div {
        flex-basis: auto;
        width: 14%;
        height: 50px;
        display: inline-block;
    }
    #daydiv {
        width: 100%;
        display: flex;
        flex-wrap: wrap
    }

    #daydiv div {
        flex-basis: auto;
        width: 14%;
        height: 50px;
        display: inline-block;
    }

    #table {
        display: block;
    }
    
    #table td {
        display: inline-block;
        width: 20px;
    }

    .button-clear {
        width: 20px;
        font-size: 2rem;
    }

</style>


<script>


var d = new Date();

//main view model
function AppViewModel() {
    this.months = ko.observableArray(["January","February","March","April","May","June","July","August","September","Ocotober","November","December"]);
    this.year = ko.observable(d.getFullYear());
    this.index = ko.observable(d.getMonth());
    this.days = ko.observableArray([]);


    //sets the date to display on top of calendar
    this.date = ko.pureComputed(function() {
        var a = this.index();
        return this.months()[a] + " | " + this.year();
    }, this);


    //determines how many days in each month, + how many days append and prepend each month.  Pushes those to the this.days array for rendering
    this.daysOfMonth = ko.pureComputed(function() {
        var month = this.index() + 1;
        var year = this.year();
        var numberOfDays = new Date(year, month, 0).getDate();
        var startDay = new Date(year, month, 1).getDay();
        
        var endDay = new Date(year, month, numberOfDays).getDay();

        //iterate and push the number of days that prepend current month
        for (var d = numberOfDays - startDay; d < numberOfDays ; d++) {
            this.days.push(d);
        }

        //iterate and push the number of days in the month
        for (var i = 1; i < numberOfDays + 1; i++) {
            this.days.push(i);
        }

        //iterate and push the number of days that append current month
        for (var l = 1; l < (7 - endDay); l++) {
            this.days.push(l);
        }
    }, this);
        
    
    //increments month when "+ button" is pushed. resets days array
    this.plusMonth = function() {
        var addIndex = this.index();
        var addYear = this.year();
        this.days([]);

        if (addIndex < 11) {
            this.index(addIndex + 1);
        }

        if (addIndex === 11) {
            this.year(addYear + 1)
            this.index(addIndex = 0);
        }
        console.log(addIndex);

    };

    //decrements month when "- button" is pushed. resets days array
    this.minusMonth = function() {
        var minusIndex = this.index();
        var minusYear = this.year();
        this.days([]);
        
        if (minusIndex > 0) {
            this.index(minusIndex - 1);
        }

        if (minusIndex === 0) {
            this.year(minusYear - 1);
            this.index(minusIndex = 11);
        }
        console.log(minusIndex);
    }
}


//initializes Knockout
ko.applyBindings(new AppViewModel());

</script>
</html>


